<html><body><h2 id="dbdesignTtl">4.11 性能評価とチューニング</h2>
<div class="section">
<p class="txt">運用フェーズに入った後のチューニング作業は、地道で困難な作業だと思われがちですが、データベースの状況を常に把握しておけば、事前にパフォーマンスの劣化を予期することもできます。<br>
データベースの各コンポーネントの動作と相互間の連携の把握、OSとの連携処理の把握、ハードウェア（メモリ、CPU、ディスク）とネットワークの状態を常に管理しておくことが、パフォーマンスチューニングの早道ということができます。</p>
<p class="txt">カットオーバー後のメンテナンス作業としては、統計情報の収集（カットオーバー直後と定期的な収集が必要）とシステム使用環境の変化（アプリケーションの追加、ユーザ数、トランザクション数、データ量の増減など）を監視する必要があります。</p>
<p class="txt">統計情報の収集を随時行うことによって、パフォーマンスが悪化したときに、どこが変化しているのかを把握することができます。<br>
変化した部分が、パフォーマンス劣化の原因になっている場合が多いのが現状です。<br>
システムの内的な要因だけではなく、アプリケーションの追加やユーザ数の増加など外的な要因にも気をつけて情報を収集する必要があります。</p>
<!--/section--></div>

<h4 class="caption">パフォーマンスダウン時のチューニング手順</h4>
<div class="section">
<p class="txt">パフォーマンス劣化が実際に起きたときのチューニングの手順を次の図で示します。</p>
<div class="grayBox">
<p><img src="./images/4011-01.gif" width="355" height="209" alt="図4-60 チューニングの手順"></p>
<p class="boxTxt">図4-60 チューニングの手順</p>
<!--/.grayBox--></div>
<p class="txt">ポイントは、統計情報からボトルネックの特定をする際、原因となっていそうな箇所が複数あっても、チューニングを行うのは必ず1つずつにするという点です。<br>
一度に複数箇所をチューニングしたくなるのはわかりますが、それを行ってしまうと、どこが本当にパフォーマンスのボトルネックになっていたのか特定できず、根本的なチューニングにならなくなってしまいます。<br>
ボトルネックを突き止めることによって、パフォーマンス劣化の原因も特定することができます。</p>
<!--/section--></div>

<h4 class="caption">チューニング手順</h4>
<div class="section">
<p class="txt">最後に、データベースのパフォーマンスチューニングを行う際の順序を紹介します。<br>
データベースのチューニングを行う際には、いきなりハードウェアの増強や、メモリの追加などを行うのではなく、SQLのチューニングから始めてください。<br>
SQLに原因があるのに、ハードウェアを増強してしまうと、それによって一時的にチューニングできたように思えるかもしれませんが、根本的な解決には至っていないため、結局パフォーマンスの劣化は遅かれ早かれやってきてしまうことになります。</p>
<p class="txt">SQLのチューニングは、データベース管理者の役目の一部でもあります。<br>
各表の統計情報の収集作業から始まって、表の構造や結合処理の方法を最適化できるように設計するのは、データベースのことを最もよく知っている管理者の役目です。</p>
<ul>
<li>1. アプリケーションチューニング：<br>
ユーザトレースを取得してSQL文のリソース使用状況、実行計画を確認する</li>
<li>● 索引が適切に使用されているか</li>
<li>● 結合のアルゴリズムは適切に選択されているか</li>
<li>● パラレル処理は適切に稼動しているか</li>
<li>● SQL文は共有化されているか</li>
<li>2. データベースサーバチューニング </li>
<li>● 断片化された領域の解消</li>
<li>● メモリ領域の拡弓尉縮小</li>
<li>● 競合の解消</li>
<li>● 大規模データを扱うときのパラレル化の検討</li>
<li>● DSS系の処理を行うときのマテリアライズドビューの使用の検討</li>
<li>3. ハードウェアのチューニング </li>
<li>● メモリの増設</li>
<li>● ネットワークの帯域幅の再考</li>
<li>● CPUのアップグレード</li>
<li>● IOのチューニング（ストライプ化の検討）</li>
</ul>
<!--/section--></div>


</body></html>